<!DOCTYPE html>
<html lang="zh-CN"><head><meta charset="UTF-8"><title>数字钱包 HD Wallet（BIP32密钥派生） – blockcasting</title><meta name="robots" content="max-image-preview:large"><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//s.w.org"><link rel="stylesheet" id="astra-theme-css-css" href="../wp-content/themes/astra/assets/css/minified/frontend.min.css" media="all"><style id="astra-theme-css-inline-css">
html{font-size:100%;}a,.page-title{color:#4a80ec;}a:hover,a:focus{color:#004de5;}body,button,input,select,textarea,.ast-button,.ast-custom-button{font-family:Verdana,Helvetica,Arial,sans-serif;font-weight:400;font-size:16px;font-size:1rem;}blockquote{color:#000000;}h1,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6,.site-title,.site-title a{font-family:Verdana,Helvetica,Arial,sans-serif;font-weight:400;}.site-title{font-size:35px;font-size:2.1875rem;}header .custom-logo-link img{max-width:246px;}.astra-logo-svg{width:246px;}.ast-archive-description .ast-archive-title{font-size:40px;font-size:2.5rem;}.site-header .site-description{font-size:15px;font-size:0.9375rem;}.entry-title{font-size:30px;font-size:1.875rem;}h1,.entry-content h1{font-size:30px;font-size:1.875rem;font-weight:400;font-family:Verdana,Helvetica,Arial,sans-serif;line-height:1.06;}h2,.entry-content h2{font-size:35px;font-size:2.1875rem;font-weight:400;font-family:Verdana,Helvetica,Arial,sans-serif;line-height:1.2;}h3,.entry-content h3{font-size:20px;font-size:1.25rem;font-weight:700;font-family:'Roboto',sans-serif;line-height:1.1;}h4,.entry-content h4{font-size:18px;font-size:1.125rem;line-height:1.1;}h5,.entry-content h5{font-size:16px;font-size:1rem;line-height:1.1;}h6,.entry-content h6{font-size:14px;font-size:0.875rem;line-height:1.1;}.ast-single-post .entry-title,.page-title{font-size:22px;font-size:1.375rem;}::selection{background-color:#004de5;color:#ffffff;}body,h1,.entry-title a,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6{color:#3a3a3a;}.tagcloud a:hover,.tagcloud a:focus,.tagcloud a.current-item{color:#ffffff;border-color:#4a80ec;background-color:#4a80ec;}input:focus,input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="reset"]:focus,input[type="search"]:focus,textarea:focus{border-color:#4a80ec;}input[type="radio"]:checked,input[type=reset],input[type="checkbox"]:checked,input[type="checkbox"]:hover:checked,input[type="checkbox"]:focus:checked,input[type=range]::-webkit-slider-thumb{border-color:#4a80ec;background-color:#4a80ec;box-shadow:none;}.site-footer a:hover + .post-count,.site-footer a:focus + .post-count{background:#4a80ec;border-color:#4a80ec;}.single .nav-links .nav-previous,.single .nav-links .nav-next{color:#4a80ec;}.entry-meta,.entry-meta *{line-height:1.45;color:#4a80ec;}.entry-meta a:hover,.entry-meta a:hover *,.entry-meta a:focus,.entry-meta a:focus *,.page-links > .page-link,.page-links .page-link:hover,.post-navigation a:hover{color:#004de5;}.widget-title{font-size:22px;font-size:1.375rem;color:#3a3a3a;}#cat option,.secondary .calendar_wrap thead a,.secondary .calendar_wrap thead a:visited{color:#4a80ec;}.secondary .calendar_wrap #today,.ast-progress-val span{background:#4a80ec;}.secondary a:hover + .post-count,.secondary a:focus + .post-count{background:#4a80ec;border-color:#4a80ec;}.calendar_wrap #today > a{color:#ffffff;}.page-links .page-link,.single .post-navigation a{color:#4a80ec;}.wp-block-buttons.aligncenter{justify-content:center;}@media (max-width:782px){.entry-content .wp-block-columns .wp-block-column{margin-left:0px;}}@media (max-width:921px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single{padding:1.5em 2.14em;}.ast-separate-container #primary,.ast-separate-container #secondary{padding:1.5em 0;}#primary,#secondary{padding:1.5em 0;margin:0;}.ast-left-sidebar #content > .ast-container{display:flex;flex-direction:column-reverse;width:100%;}.ast-author-box img.avatar{margin:20px 0 0 0;}}@media (max-width:921px){.ast-right-sidebar #primary{padding-right:0;}}@media (min-width:922px){.ast-separate-container.ast-right-sidebar #primary,.ast-separate-container.ast-left-sidebar #primary{border:0;}.search-no-results.ast-separate-container #primary{margin-bottom:4em;}}@media (min-width:922px){.ast-right-sidebar #primary{border-right:1px solid #eee;}.ast-left-sidebar #primary{border-left:1px solid #eee;}}.elementor-button-wrapper .elementor-button{border-style:solid;border-top-width:0;border-right-width:0;border-left-width:0;border-bottom-width:0;}body .elementor-button.elementor-size-sm,body .elementor-button.elementor-size-xs,body .elementor-button.elementor-size-md,body .elementor-button.elementor-size-lg,body .elementor-button.elementor-size-xl,body .elementor-button{border-radius:50px;padding-top:15px;padding-right:40px;padding-bottom:16px;padding-left:40px;}.elementor-button-wrapper .elementor-button{border-color:rgba(9,132,225,0);background-color:rgba(9,132,225,0);}.elementor-button-wrapper .elementor-button:hover,.elementor-button-wrapper .elementor-button:focus{color:#ffffff;background-color:rgba(75,129,236,0);border-color:rgba(75,129,236,0);}.wp-block-button .wp-block-button__link,.elementor-button-wrapper .elementor-button,.elementor-button-wrapper .elementor-button:visited{color:#ffffff;}.elementor-button-wrapper .elementor-button{font-family:Helvetica,Verdana,Arial,sans-serif;font-weight:400;line-height:1;}body .elementor-button.elementor-size-sm,body .elementor-button.elementor-size-xs,body .elementor-button.elementor-size-md,body .elementor-button.elementor-size-lg,body .elementor-button.elementor-size-xl,body .elementor-button{font-size:12px;font-size:0.75rem;}.wp-block-button .wp-block-button__link{border-style:solid;border-top-width:0;border-right-width:0;border-left-width:0;border-bottom-width:0;border-color:rgba(9,132,225,0);background-color:rgba(9,132,225,0);color:#ffffff;font-family:Helvetica,Verdana,Arial,sans-serif;font-weight:400;line-height:1;font-size:12px;font-size:0.75rem;border-radius:50px;padding-top:15px;padding-right:40px;padding-bottom:16px;padding-left:40px;}.wp-block-button .wp-block-button__link:hover,.wp-block-button .wp-block-button__link:focus{color:#ffffff;background-color:rgba(75,129,236,0);border-color:rgba(75,129,236,0);}.elementor-widget-heading h1.elementor-heading-title{line-height:1.06;}.elementor-widget-heading h2.elementor-heading-title{line-height:1.2;}.elementor-widget-heading h3.elementor-heading-title{line-height:1.1;}.elementor-widget-heading h4.elementor-heading-title{line-height:1.1;}.elementor-widget-heading h5.elementor-heading-title{line-height:1.1;}.elementor-widget-heading h6.elementor-heading-title{line-height:1.1;}.menu-toggle,button,.ast-button,.ast-custom-button,.button,input#submit,input[type="button"],input[type="submit"],input[type="reset"]{border-style:solid;border-top-width:0;border-right-width:0;border-left-width:0;border-bottom-width:0;color:#ffffff;border-color:rgba(9,132,225,0);background-color:rgba(9,132,225,0);border-radius:50px;padding-top:15px;padding-right:40px;padding-bottom:16px;padding-left:40px;font-family:Helvetica,Verdana,Arial,sans-serif;font-weight:400;font-size:12px;font-size:0.75rem;line-height:1;}button:focus,.menu-toggle:hover,button:hover,.ast-button:hover,.ast-custom-button:hover .button:hover,.ast-custom-button:hover ,input[type=reset]:hover,input[type=reset]:focus,input#submit:hover,input#submit:focus,input[type="button"]:hover,input[type="button"]:focus,input[type="submit"]:hover,input[type="submit"]:focus{color:#ffffff;background-color:rgba(75,129,236,0);border-color:rgba(75,129,236,0);}@media (min-width:921px){.ast-container{max-width:100%;}}@media (min-width:544px){.ast-container{max-width:100%;}}@media (max-width:544px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single{padding:1.5em 1em;}.ast-separate-container #content .ast-container{padding-left:0.54em;padding-right:0.54em;}.ast-separate-container .ast-archive-description{padding:1.5em 1em;}.ast-search-menu-icon.ast-dropdown-active .search-field{width:170px;}}@media (max-width:921px){.ast-mobile-header-stack .main-header-bar .ast-search-menu-icon{display:inline-block;}.ast-header-break-point.ast-header-custom-item-outside .ast-mobile-header-stack .main-header-bar .ast-search-icon{margin:0;}}@media (min-width:545px){.ast-page-builder-template .comments-area,.single.ast-page-builder-template .entry-header,.single.ast-page-builder-template .post-navigation{max-width:933px;margin-left:auto;margin-right:auto;}}body,.ast-separate-container{background-color:#fafafa;;background-image:none;;}@media (max-width:921px){.ast-archive-description .ast-archive-title{font-size:40px;}.entry-title{font-size:30px;}h1,.entry-content h1{font-size:30px;}h2,.entry-content h2{font-size:25px;}h3,.entry-content h3{font-size:20px;}.ast-single-post .entry-title,.page-title{font-size:22px;}}@media (max-width:544px){.ast-archive-description .ast-archive-title{font-size:40px;}.entry-title{font-size:30px;}h1,.entry-content h1{font-size:22px;}h2,.entry-content h2{font-size:25px;}h3,.entry-content h3{font-size:20px;}.ast-single-post .entry-title,.page-title{font-size:20px;}.ast-header-break-point .site-branding img,.ast-header-break-point .custom-logo-link img{max-width:110px;}.astra-logo-svg{width:110px;}.ast-header-break-point .site-logo-img .custom-mobile-logo-link img{max-width:110px;}}@media (max-width:921px){html{font-size:91.2%;}}@media (max-width:544px){html{font-size:91.2%;}}@media (min-width:922px){.ast-container{max-width:933px;}}@font-face {font-family: "Astra";src: url(http://OFFLINEZIP.wpsho/wp-content/themes/astra/assets/fonts/astra.woff) format("woff"),url(http://OFFLINEZIP.wpsho/wp-content/themes/astra/assets/fonts/astra.ttf) format("truetype"),url(http://OFFLINEZIP.wpsho/wp-content/themes/astra/assets/fonts/astra.svg#astra) format("svg");font-weight: normal;font-style: normal;font-display: fallback;}@media (min-width:922px){.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu:hover > .sub-menu,.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu.focus > .sub-menu{margin-left:-0px;}}.ast-breadcrumbs .trail-browse,.ast-breadcrumbs .trail-items,.ast-breadcrumbs .trail-items li{display:inline-block;margin:0;padding:0;border:none;background:inherit;text-indent:0;}.ast-breadcrumbs .trail-browse{font-size:inherit;font-style:inherit;font-weight:inherit;color:inherit;}.ast-breadcrumbs .trail-items{list-style:none;}.trail-items li::after{padding:0 0.3em;content:"\00bb";}.trail-items li:last-of-type::after{display:none;}h1,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6{color:#2f3f50;}@media (max-width:921px){.ast-builder-grid-row-container.ast-builder-grid-row-tablet-6-equal .ast-builder-grid-row{grid-template-columns:repeat( 6,1fr );}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-5-equal .ast-builder-grid-row{grid-template-columns:repeat( 5,1fr );}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-4-equal .ast-builder-grid-row{grid-template-columns:repeat( 4,1fr );}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-4-lheavy .ast-builder-grid-row{grid-template-columns:2fr 1fr 1fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-4-rheavy .ast-builder-grid-row{grid-template-columns:1fr 1fr 1fr 2fr;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-equal .ast-builder-grid-row{grid-template-columns:repeat( 3,1fr );}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-lheavy .ast-builder-grid-row{grid-template-columns:2fr 1fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-rheavy .ast-builder-grid-row{grid-template-columns:1fr 1fr 2fr;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-cheavy .ast-builder-grid-row{grid-template-columns:1fr 2fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-cwide .ast-builder-grid-row{grid-template-columns:1fr 3fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-firstrow .ast-builder-grid-row{grid-template-columns:1fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-firstrow .ast-builder-grid-row > *:first-child{grid-column:1 / -1;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-lastrow .ast-builder-grid-row{grid-template-columns:1fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-lastrow .ast-builder-grid-row > *:last-child{grid-column:1 / -1;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-2-equal .ast-builder-grid-row{grid-template-columns:repeat( 2,1fr );}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-2-lheavy .ast-builder-grid-row{grid-template-columns:2fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-2-rheavy .ast-builder-grid-row{grid-template-columns:1fr 2fr;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-full .ast-builder-grid-row{grid-template-columns:1fr;}}@media (max-width:544px){.ast-builder-grid-row-container.ast-builder-grid-row-mobile-6-equal .ast-builder-grid-row{grid-template-columns:repeat( 6,1fr );}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-5-equal .ast-builder-grid-row{grid-template-columns:repeat( 5,1fr );}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-4-equal .ast-builder-grid-row{grid-template-columns:repeat( 4,1fr );}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-4-lheavy .ast-builder-grid-row{grid-template-columns:2fr 1fr 1fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-4-rheavy .ast-builder-grid-row{grid-template-columns:1fr 1fr 1fr 2fr;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-equal .ast-builder-grid-row{grid-template-columns:repeat( 3,1fr );}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-lheavy .ast-builder-grid-row{grid-template-columns:2fr 1fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-rheavy .ast-builder-grid-row{grid-template-columns:1fr 1fr 2fr;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-cheavy .ast-builder-grid-row{grid-template-columns:1fr 2fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-cwide .ast-builder-grid-row{grid-template-columns:1fr 3fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-firstrow .ast-builder-grid-row{grid-template-columns:1fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-firstrow .ast-builder-grid-row > *:first-child{grid-column:1 / -1;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-lastrow .ast-builder-grid-row{grid-template-columns:1fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-lastrow .ast-builder-grid-row > *:last-child{grid-column:1 / -1;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-2-equal .ast-builder-grid-row{grid-template-columns:repeat( 2,1fr );}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-2-lheavy .ast-builder-grid-row{grid-template-columns:2fr 1fr;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-2-rheavy .ast-builder-grid-row{grid-template-columns:1fr 2fr;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-full .ast-builder-grid-row{grid-template-columns:1fr;}}.ast-builder-layout-element .ast-site-identity .site-title a{color:#ffffff;}.ast-builder-layout-element[data-section="title_tagline"]{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-builder-layout-element[data-section="title_tagline"]{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-builder-layout-element[data-section="title_tagline"]{display:flex;}}.ast-builder-menu-1{font-family:inherit;font-weight:500;}.ast-builder-menu-1 .menu-item > .menu-link{font-size:16px;font-size:1rem;color:rgba(51,51,51,0.8);}.ast-builder-menu-1 .menu-item > .ast-menu-toggle{color:rgba(51,51,51,0.8);}.ast-builder-menu-1 .menu-item:hover > .menu-link,.ast-builder-menu-1 .inline-on-mobile .menu-item:hover > .ast-menu-toggle{color:#000000;}.ast-builder-menu-1 .menu-item:hover > .ast-menu-toggle{color:#000000;}.ast-builder-menu-1 .menu-item.current-menu-item > .menu-link,.ast-builder-menu-1 .inline-on-mobile .menu-item.current-menu-item > .ast-menu-toggle,.ast-builder-menu-1 .current-menu-ancestor > .menu-link{color:#000000;}.ast-builder-menu-1 .menu-item.current-menu-item > .ast-menu-toggle{color:#000000;}.ast-builder-menu-1 .sub-menu,.ast-builder-menu-1 .inline-on-mobile .sub-menu{border-top-width:0;border-bottom-width:0;border-right-width:0;border-left-width:0;border-color:#adadad;border-style:solid;border-radius:0;}.ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu,.ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper{margin-top:0;}.ast-desktop .ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu:before,.ast-desktop .ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper:before{height:calc( 0px + 5px );}.ast-desktop .ast-builder-menu-1 .menu-item .sub-menu .menu-link{border-bottom-width:1px;border-color:rgba(39,44,108,0.15);border-style:solid;}.ast-desktop .ast-builder-menu-1 .menu-item .sub-menu .menu-item:last-child .menu-link{border-bottom-width:0;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-1 .main-header-menu .menu-item > .menu-link{color:#191a19;padding-top:0px;padding-bottom:0px;padding-left:20px;padding-right:20px;}.ast-builder-menu-1 .menu-item > .ast-menu-toggle{color:#191a19;}.ast-builder-menu-1 .menu-item:hover > .menu-link,.ast-builder-menu-1 .inline-on-mobile .menu-item:hover > .ast-menu-toggle{color:#4a80ec;}.ast-builder-menu-1 .menu-item:hover > .ast-menu-toggle{color:#4a80ec;}.ast-builder-menu-1 .menu-item.current-menu-item > .menu-link,.ast-builder-menu-1 .inline-on-mobile .menu-item.current-menu-item > .ast-menu-toggle,.ast-builder-menu-1 .current-menu-ancestor > .menu-link,.ast-builder-menu-1 .current-menu-ancestor > .ast-menu-toggle{color:#4a80ec;}.ast-builder-menu-1 .menu-item.current-menu-item > .ast-menu-toggle{color:#4a80ec;}.ast-header-break-point .ast-builder-menu-1 .menu-item.menu-item-has-children > .ast-menu-toggle{top:0px;right:calc( 20px - 0.907em );}.ast-builder-menu-1 .menu-item-has-children > .menu-link:after{content:unset;}.ast-builder-menu-1 .main-header-menu,.ast-builder-menu-1 .main-header-menu .sub-menu{background-color:#ffffff;;background-image:none;;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-1 .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}}.ast-builder-menu-1{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-1{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-1{display:flex;}}.footer-widget-area[data-section="section-fb-html-1"] .ast-builder-html-element{color:#ffffff;font-size:16px;font-size:1rem;}@media (max-width:921px){.footer-widget-area[data-section="section-fb-html-1"] .ast-builder-html-element{font-size:15px;font-size:0.9375rem;}}@media (max-width:544px){.footer-widget-area[data-section="section-fb-html-1"] .ast-builder-html-element{font-size:15px;font-size:0.9375rem;}}.footer-widget-area[data-section="section-fb-html-1"]{font-size:16px;font-size:1rem;}@media (max-width:921px){.footer-widget-area[data-section="section-fb-html-1"]{font-size:15px;font-size:0.9375rem;}}@media (max-width:544px){.footer-widget-area[data-section="section-fb-html-1"]{font-size:15px;font-size:0.9375rem;}}.footer-widget-area[data-section="section-fb-html-1"]{display:block;}@media (max-width:921px){.ast-header-break-point .footer-widget-area[data-section="section-fb-html-1"]{display:block;}}@media (max-width:544px){.ast-header-break-point .footer-widget-area[data-section="section-fb-html-1"]{display:block;}}.footer-widget-area[data-section="section-fb-html-2"]{display:block;}@media (max-width:921px){.ast-header-break-point .footer-widget-area[data-section="section-fb-html-2"]{display:block;}}@media (max-width:544px){.ast-header-break-point .footer-widget-area[data-section="section-fb-html-2"]{display:block;}}.footer-widget-area[data-section="section-fb-html-1"] .ast-builder-html-element{text-align:right;}@media (max-width:921px){.footer-widget-area[data-section="section-fb-html-1"] .ast-builder-html-element{text-align:right;}}@media (max-width:544px){.footer-widget-area[data-section="section-fb-html-1"] .ast-builder-html-element{text-align:center;}}.footer-widget-area[data-section="section-fb-html-2"] .ast-builder-html-element{text-align:center;}@media (max-width:921px){.footer-widget-area[data-section="section-fb-html-2"] .ast-builder-html-element{text-align:center;}}@media (max-width:544px){.footer-widget-area[data-section="section-fb-html-2"] .ast-builder-html-element{text-align:center;}}.site-above-footer-wrap[data-section="section-above-footer-builder"]{min-height:60px;}.site-above-footer-wrap[data-section="section-above-footer-builder"] .ast-builder-grid-row{max-width:893px;margin-left:auto;margin-right:auto;}.site-above-footer-wrap[data-section="section-above-footer-builder"] .ast-builder-grid-row,.site-above-footer-wrap[data-section="section-above-footer-builder"] .site-footer-section{align-items:flex-start;}.site-above-footer-wrap[data-section="section-above-footer-builder"].ast-footer-row-inline .site-footer-section{display:flex;margin-bottom:0;}@media (max-width:921px){.site-above-footer-wrap[data-section="section-above-footer-builder"].ast-footer-row-tablet-inline .site-footer-section{display:flex;margin-bottom:0;}.site-above-footer-wrap[data-section="section-above-footer-builder"].ast-footer-row-tablet-stack .site-footer-section{display:block;margin-bottom:10px;}}@media (max-width:544px){.site-above-footer-wrap[data-section="section-above-footer-builder"].ast-footer-row-mobile-inline .site-footer-section{display:flex;margin-bottom:0;}.site-above-footer-wrap[data-section="section-above-footer-builder"].ast-footer-row-mobile-stack .site-footer-section{display:block;margin-bottom:10px;}}.site-above-footer-wrap[data-section="section-above-footer-builder"]{display:grid;}@media (max-width:921px){.ast-header-break-point .site-above-footer-wrap[data-section="section-above-footer-builder"]{display:grid;}}@media (max-width:544px){.ast-header-break-point .site-above-footer-wrap[data-section="section-above-footer-builder"]{display:grid;}}.site-footer{background-color:#ffffff;;background-image:none;;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{background-image:linear-gradient(176deg,rgb(9,132,227) 15%,rgb(0,59,177) 75%);;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .ast-builder-grid-row{max-width:893px;margin-left:auto;margin-right:auto;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .ast-builder-grid-row,.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .site-footer-section{align-items:flex-start;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-inline .site-footer-section{display:flex;margin-bottom:0;}@media (max-width:921px){.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-tablet-inline .site-footer-section{display:flex;margin-bottom:0;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-tablet-stack .site-footer-section{display:block;margin-bottom:10px;}}@media (max-width:544px){.site-footer{background-color:#ffffff;;background-image:none;;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-mobile-inline .site-footer-section{display:flex;margin-bottom:0;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-mobile-stack .site-footer-section{display:block;margin-bottom:10px;}}.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{padding-top:100px;padding-bottom:75px;padding-left:30px;padding-right:30px;}@media (max-width:921px){.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{padding-top:80px;padding-bottom:60px;padding-left:25px;padding-right:25px;}}@media (max-width:544px){.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{padding-top:80px;padding-bottom:60px;padding-left:20px;padding-right:20px;}}.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}@media (max-width:921px){.ast-header-break-point .site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}}@media (max-width:544px){.ast-header-break-point .site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}}.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"] .footer-widget-area-inner{text-align:right;}@media (max-width:921px){.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"] .footer-widget-area-inner{text-align:right;}}@media (max-width:544px){.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"] .footer-widget-area-inner{text-align:right;}}.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"] .footer-widget-area-inner{color:#ffffff;}.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"] .widget-title{color:#ffffff;font-size:35px;font-size:2.1875rem;}@media (max-width:544px){.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"] .widget-title{font-size:32px;font-size:2rem;}}.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"]{display:block;}@media (max-width:921px){.ast-header-break-point .footer-widget-area[data-section="sidebar-widgets-footer-widget-1"]{display:block;}}@media (max-width:544px){.ast-header-break-point .footer-widget-area[data-section="sidebar-widgets-footer-widget-1"]{display:block;}}.footer-widget-area[data-section="sidebar-widgets-footer-widget-2"]{display:block;}@media (max-width:921px){.ast-header-break-point .footer-widget-area[data-section="sidebar-widgets-footer-widget-2"]{display:block;}}@media (max-width:544px){.ast-header-break-point .footer-widget-area[data-section="sidebar-widgets-footer-widget-2"]{display:block;}}.footer-widget-area[data-section="sidebar-widgets-footer-widget-2"] .footer-widget-area-inner{text-align:left;}@media (max-width:921px){.footer-widget-area[data-section="sidebar-widgets-footer-widget-2"] .footer-widget-area-inner{text-align:left;}}@media (max-width:544px){.footer-widget-area[data-section="sidebar-widgets-footer-widget-2"] .footer-widget-area-inner{text-align:center;}}.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"] .footer-widget-area-inner{color:#ffffff;}.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"] .widget-title{color:#ffffff;font-size:35px;font-size:2.1875rem;}@media (max-width:544px){.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"] .widget-title{font-size:32px;font-size:2rem;}}.footer-widget-area[data-section="sidebar-widgets-footer-widget-1"]{display:block;}@media (max-width:921px){.ast-header-break-point .footer-widget-area[data-section="sidebar-widgets-footer-widget-1"]{display:block;}}@media (max-width:544px){.ast-header-break-point .footer-widget-area[data-section="sidebar-widgets-footer-widget-1"]{display:block;}}.footer-widget-area[data-section="sidebar-widgets-footer-widget-2"]{display:block;}@media (max-width:921px){.ast-header-break-point .footer-widget-area[data-section="sidebar-widgets-footer-widget-2"]{display:block;}}@media (max-width:544px){.ast-header-break-point .footer-widget-area[data-section="sidebar-widgets-footer-widget-2"]{display:block;}}.elementor-widget-heading .elementor-heading-title{margin:0;}.elementor-post.elementor-grid-item.hentry{margin-bottom:0;}.woocommerce div.product .elementor-element.elementor-products-grid .related.products ul.products li.product,.elementor-element .elementor-wc-products .woocommerce[class*='columns-'] ul.products li.product{width:auto;margin:0;float:none;}.ast-left-sidebar .elementor-section.elementor-section-stretched,.ast-right-sidebar .elementor-section.elementor-section-stretched{max-width:100%;left:0 !important;}.ast-header-break-point .main-header-bar{border-bottom-width:1px;border-bottom-color:#dbdee0;}@media (min-width:922px){.main-header-bar{border-bottom-width:1px;border-bottom-color:#dbdee0;}}.ast-safari-browser-less-than-11 .main-header-menu .menu-item, .ast-safari-browser-less-than-11 .main-header-bar .ast-masthead-custom-menu-items{display:block;}.main-header-menu .menu-item, .main-header-bar .ast-masthead-custom-menu-items{-js-display:flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;}.main-header-menu > .menu-item > .menu-link{height:100%;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-js-display:flex;display:flex;}.ast-primary-menu-disabled .main-header-bar .ast-masthead-custom-menu-items{flex:unset;}.header-main-layout-1 .ast-flex.main-header-container, .header-main-layout-3 .ast-flex.main-header-container{-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;}.ast-mobile-popup-drawer.active .ast-mobile-popup-inner{background-color:#ffffff;;color:#3a3a3a;}.ast-mobile-header-wrap .ast-mobile-header-content{background-color:#ffffff;;}.ast-mobile-popup-content > *, .ast-mobile-header-content > *{padding-top:0;padding-bottom:0;}@media (max-width:921px){.content-align-flex-start .ast-builder-layout-element{justify-content:flex-start;}.content-align-flex-start .main-header-menu{text-align:left;}}.ast-mobile-header-wrap .ast-primary-header-bar,.ast-primary-header-bar .site-primary-header-wrap{min-height:50px;}.ast-desktop .ast-primary-header-bar .main-header-menu > .menu-item{line-height:50px;}#masthead .ast-container,.site-header-focus-item + .ast-breadcrumbs-wrapper{max-width:100%;padding-left:35px;padding-right:35px;}@media (max-width:921px){#masthead .ast-mobile-header-wrap .ast-above-header-bar,#masthead .ast-mobile-header-wrap .ast-primary-header-bar,#masthead .ast-mobile-header-wrap .ast-below-header-bar{padding-left:20px;padding-right:20px;}}.ast-header-break-point .ast-primary-header-bar{border-bottom-width:0;border-bottom-color:#dbdee0;border-bottom-style:solid;}@media (min-width:922px){.ast-primary-header-bar{border-bottom-width:0;border-bottom-color:#dbdee0;border-bottom-style:solid;}}.ast-primary-header-bar{background-color:#ffffff;;background-image:none;;}@media (max-width:921px){.ast-primary-header-bar.ast-primary-header{background-color:#272c6c;;background-image:none;;}}@media (max-width:544px){.ast-primary-header-bar.ast-primary-header{background-color:#ffffff;;background-image:none;;}}.ast-desktop .ast-primary-header-bar.main-header-bar, .ast-header-break-point #masthead .ast-primary-header-bar.main-header-bar{padding-top:10px;padding-bottom:10px;}@media (max-width:921px){.ast-desktop .ast-primary-header-bar.main-header-bar, .ast-header-break-point #masthead .ast-primary-header-bar.main-header-bar{padding-top:1em;padding-bottom:1em;}}@media (max-width:544px){.ast-desktop .ast-primary-header-bar.main-header-bar, .ast-header-break-point #masthead .ast-primary-header-bar.main-header-bar{padding-top:0em;padding-bottom:0em;padding-left:0em;padding-right:0em;}}.ast-primary-header-bar{display:block;}@media (max-width:921px){.ast-header-break-point .ast-primary-header-bar{display:grid;}}@media (max-width:544px){.ast-header-break-point .ast-primary-header-bar{display:grid;}}[data-section="section-header-mobile-trigger"] .ast-button-wrap .ast-mobile-menu-trigger-fill{color:#191a19;border:none;background:#ffffff;border-radius:2px;}[data-section="section-header-mobile-trigger"] .ast-button-wrap .mobile-menu-toggle-icon .ast-mobile-svg{width:20px;height:20px;fill:#191a19;}[data-section="section-header-mobile-trigger"] .ast-button-wrap .mobile-menu-wrap .mobile-menu{color:#191a19;}
</style><link rel="stylesheet" id="astra-google-fonts-css" href="//fonts.googleapis.com/css?family=Roboto%3A700&display=fallback&ver=3.2.0" media="all"><link rel="stylesheet" id="astra-menu-animation-css" href="../wp-content/themes/astra/assets/css/minified/menu-animation.min.css" media="all"><link rel="stylesheet" id="wp-block-library-css" href="../wp-includes/css/dist/block-library/style.min.css" media="all"><link rel="stylesheet" id="wc-block-vendors-style-css" href="../wp-content/plugins/woocommerce/packages/woocommerce-blocks/build/vendors-style.css" media="all"><link rel="stylesheet" id="wc-block-style-css" href="../wp-content/plugins/woocommerce/packages/woocommerce-blocks/build/style.css" media="all"><link rel="stylesheet" id="woocommerce-layout-css" href="../wp-content/themes/astra/assets/css/minified/compatibility/woocommerce/woocommerce-layout.min.css" media="all"><link rel="stylesheet" id="woocommerce-smallscreen-css" href="../wp-content/themes/astra/assets/css/minified/compatibility/woocommerce/woocommerce-smallscreen.min.css" media="only screen and (max-width: 921px)"><link rel="stylesheet" id="woocommerce-general-css" href="../wp-content/themes/astra/assets/css/minified/compatibility/woocommerce/woocommerce.min.css" media="all"><style id="woocommerce-general-inline-css">
.woocommerce span.onsale, .wc-block-grid__product .wc-block-grid__product-onsale{background-color:#004de5;color:#ffffff;}.woocommerce a.button, .woocommerce button.button, .woocommerce .woocommerce-message a.button, .woocommerce #respond input#submit.alt, .woocommerce a.button.alt, .woocommerce button.button.alt, .woocommerce input.button.alt, .woocommerce input.button,.woocommerce input.button:disabled, .woocommerce input.button:disabled[disabled], .woocommerce input.button:disabled:hover, .woocommerce input.button:disabled[disabled]:hover, .woocommerce #respond input#submit, .woocommerce button.button.alt.disabled, .wc-block-grid__products .wc-block-grid__product .wp-block-button__link, .wc-block-grid__product-onsale{color:#ffffff;border-color:rgba(9,132,225,0);background-color:rgba(9,132,225,0);}.woocommerce a.button:hover, .woocommerce button.button:hover, .woocommerce .woocommerce-message a.button:hover,.woocommerce #respond input#submit:hover,.woocommerce #respond input#submit.alt:hover, .woocommerce a.button.alt:hover, .woocommerce button.button.alt:hover, .woocommerce input.button.alt:hover, .woocommerce input.button:hover, .woocommerce button.button.alt.disabled:hover, .wc-block-grid__products .wc-block-grid__product .wp-block-button__link:hover{color:#ffffff;border-color:rgba(75,129,236,0);background-color:rgba(75,129,236,0);}.woocommerce-message, .woocommerce-info{border-top-color:#4a80ec;}.woocommerce-message::before,.woocommerce-info::before{color:#4a80ec;}.woocommerce ul.products li.product .price, .woocommerce div.product p.price, .woocommerce div.product span.price, .widget_layered_nav_filters ul li.chosen a, .woocommerce-page ul.products li.product .ast-woo-product-category, .wc-layered-nav-rating a{color:#3a3a3a;}.woocommerce nav.woocommerce-pagination ul,.woocommerce nav.woocommerce-pagination ul li{border-color:#4a80ec;}.woocommerce nav.woocommerce-pagination ul li a:focus, .woocommerce nav.woocommerce-pagination ul li a:hover, .woocommerce nav.woocommerce-pagination ul li span.current{background:#4a80ec;color:#ffffff;}.woocommerce-MyAccount-navigation-link.is-active a{color:#004de5;}.woocommerce .widget_price_filter .ui-slider .ui-slider-range, .woocommerce .widget_price_filter .ui-slider .ui-slider-handle{background-color:#4a80ec;}.woocommerce a.button, .woocommerce button.button, .woocommerce .woocommerce-message a.button, .woocommerce #respond input#submit.alt, .woocommerce a.button.alt, .woocommerce button.button.alt, .woocommerce input.button.alt, .woocommerce input.button,.woocommerce-cart table.cart td.actions .button, .woocommerce form.checkout_coupon .button, .woocommerce #respond input#submit, .wc-block-grid__products .wc-block-grid__product .wp-block-button__link{border-radius:50px;padding-top:15px;padding-right:40px;padding-bottom:16px;padding-left:40px;}.woocommerce .star-rating, .woocommerce .comment-form-rating .stars a, .woocommerce .star-rating::before{color:#4a80ec;}.woocommerce div.product .woocommerce-tabs ul.tabs li.active:before{background:#4a80ec;}.woocommerce a.remove:hover{color:#4a80ec;border-color:#4a80ec;background-color:#ffffff;}@media (min-width:545px) and (max-width:921px){.woocommerce.tablet-columns-6 ul.products li.product, .woocommerce-page.tablet-columns-6 ul.products li.product{width:calc(16.66% - 16.66px);}.woocommerce.tablet-columns-5 ul.products li.product, .woocommerce-page.tablet-columns-5 ul.products li.product{width:calc(20% - 16px);}.woocommerce.tablet-columns-4 ul.products li.product, .woocommerce-page.tablet-columns-4 ul.products li.product{width:calc(25% - 15px);}.woocommerce.tablet-columns-3 ul.products li.product, .woocommerce-page.tablet-columns-3 ul.products li.product{width:calc(33.33% - 14px);}.woocommerce.tablet-columns-2 ul.products li.product, .woocommerce-page.tablet-columns-2 ul.products li.product{width:calc(50% - 10px);}.woocommerce.tablet-columns-1 ul.products li.product, .woocommerce-page.tablet-columns-1 ul.products li.product{width:100%;}.woocommerce div.product .related.products ul.products li.product{width:calc(33.33% - 14px);}}@media (min-width:545px) and (max-width:921px){.woocommerce[class*="columns-"].columns-3 > ul.products li.product, .woocommerce[class*="columns-"].columns-4 > ul.products li.product, .woocommerce[class*="columns-"].columns-5 > ul.products li.product, .woocommerce[class*="columns-"].columns-6 > ul.products li.product{width:calc(33.33% - 14px);margin-right:20px;}.woocommerce[class*="columns-"].columns-3 > ul.products li.product:nth-child(3n), .woocommerce[class*="columns-"].columns-4 > ul.products li.product:nth-child(3n), .woocommerce[class*="columns-"].columns-5 > ul.products li.product:nth-child(3n), .woocommerce[class*="columns-"].columns-6 > ul.products li.product:nth-child(3n){margin-right:0;clear:right;}.woocommerce[class*="columns-"].columns-3 > ul.products li.product:nth-child(3n+1), .woocommerce[class*="columns-"].columns-4 > ul.products li.product:nth-child(3n+1), .woocommerce[class*="columns-"].columns-5 > ul.products li.product:nth-child(3n+1), .woocommerce[class*="columns-"].columns-6 > ul.products li.product:nth-child(3n+1){clear:left;}.woocommerce[class*="columns-"] ul.products li.product:nth-child(n), .woocommerce-page[class*="columns-"] ul.products li.product:nth-child(n){margin-right:20px;clear:none;}.woocommerce.tablet-columns-2 ul.products li.product:nth-child(2n), .woocommerce-page.tablet-columns-2 ul.products li.product:nth-child(2n), .woocommerce.tablet-columns-3 ul.products li.product:nth-child(3n), .woocommerce-page.tablet-columns-3 ul.products li.product:nth-child(3n), .woocommerce.tablet-columns-4 ul.products li.product:nth-child(4n), .woocommerce-page.tablet-columns-4 ul.products li.product:nth-child(4n), .woocommerce.tablet-columns-5 ul.products li.product:nth-child(5n), .woocommerce-page.tablet-columns-5 ul.products li.product:nth-child(5n), .woocommerce.tablet-columns-6 ul.products li.product:nth-child(6n), .woocommerce-page.tablet-columns-6 ul.products li.product:nth-child(6n){margin-right:0;clear:right;}.woocommerce.tablet-columns-2 ul.products li.product:nth-child(2n+1), .woocommerce-page.tablet-columns-2 ul.products li.product:nth-child(2n+1), .woocommerce.tablet-columns-3 ul.products li.product:nth-child(3n+1), .woocommerce-page.tablet-columns-3 ul.products li.product:nth-child(3n+1), .woocommerce.tablet-columns-4 ul.products li.product:nth-child(4n+1), .woocommerce-page.tablet-columns-4 ul.products li.product:nth-child(4n+1), .woocommerce.tablet-columns-5 ul.products li.product:nth-child(5n+1), .woocommerce-page.tablet-columns-5 ul.products li.product:nth-child(5n+1), .woocommerce.tablet-columns-6 ul.products li.product:nth-child(6n+1), .woocommerce-page.tablet-columns-6 ul.products li.product:nth-child(6n+1){clear:left;}.woocommerce div.product .related.products ul.products li.product:nth-child(3n){margin-right:0;clear:right;}.woocommerce div.product .related.products ul.products li.product:nth-child(3n+1){clear:left;}}@media (min-width:922px){.woocommerce #reviews #comments{width:55%;float:left;}.woocommerce #reviews #review_form_wrapper{width:45%;float:right;padding-left:2em;}.woocommerce form.checkout_coupon{width:50%;}}@media (max-width:921px){.ast-header-break-point.ast-woocommerce-cart-menu .header-main-layout-1.ast-mobile-header-stack.ast-no-menu-items .ast-site-header-cart, .ast-header-break-point.ast-woocommerce-cart-menu .header-main-layout-3.ast-mobile-header-stack.ast-no-menu-items .ast-site-header-cart{padding-right:0;padding-left:0;}.ast-header-break-point.ast-woocommerce-cart-menu .header-main-layout-1.ast-mobile-header-stack .main-header-bar{text-align:center;}.ast-header-break-point.ast-woocommerce-cart-menu .header-main-layout-1.ast-mobile-header-stack .ast-site-header-cart, .ast-header-break-point.ast-woocommerce-cart-menu .header-main-layout-1.ast-mobile-header-stack .ast-mobile-menu-buttons{display:inline-block;}.ast-header-break-point.ast-woocommerce-cart-menu .header-main-layout-2.ast-mobile-header-inline .site-branding{flex:auto;}.ast-header-break-point.ast-woocommerce-cart-menu .header-main-layout-3.ast-mobile-header-stack .site-branding{flex:0 0 100%;}.ast-header-break-point.ast-woocommerce-cart-menu .header-main-layout-3.ast-mobile-header-stack .main-header-container{display:flex;justify-content:center;}.woocommerce-cart .woocommerce-shipping-calculator .button{width:100%;}.woocommerce div.product div.images, .woocommerce div.product div.summary, .woocommerce #content div.product div.images, .woocommerce #content div.product div.summary, .woocommerce-page div.product div.images, .woocommerce-page div.product div.summary, .woocommerce-page #content div.product div.images, .woocommerce-page #content div.product div.summary{float:none;width:100%;}.woocommerce-cart table.cart td.actions .ast-return-to-shop{display:block;text-align:center;margin-top:1em;}}@media (max-width:544px){.ast-separate-container .ast-woocommerce-container{padding:.54em 1em 1.33333em;}.woocommerce-message, .woocommerce-error, .woocommerce-info{display:flex;flex-wrap:wrap;}.woocommerce-message a.button, .woocommerce-error a.button, .woocommerce-info a.button{order:1;margin-top:.5em;}.woocommerce.mobile-columns-6 ul.products li.product, .woocommerce-page.mobile-columns-6 ul.products li.product{width:calc(16.66% - 16.66px);}.woocommerce.mobile-columns-5 ul.products li.product, .woocommerce-page.mobile-columns-5 ul.products li.product{width:calc(20% - 16px);}.woocommerce.mobile-columns-4 ul.products li.product, .woocommerce-page.mobile-columns-4 ul.products li.product{width:calc(25% - 15px);}.woocommerce.mobile-columns-3 ul.products li.product, .woocommerce-page.mobile-columns-3 ul.products li.product{width:calc(33.33% - 14px);}.woocommerce.mobile-columns-2 ul.products li.product, .woocommerce-page.mobile-columns-2 ul.products li.product{width:calc(50% - 10px);}.woocommerce.mobile-columns-1 ul.products li.product, .woocommerce-page.mobile-columns-1 ul.products li.product{width:100%;}.woocommerce .woocommerce-ordering, .woocommerce-page .woocommerce-ordering{float:none;margin-bottom:2em;width:100%;}.woocommerce ul.products a.button, .woocommerce-page ul.products a.button{padding:0.5em 0.75em;}.woocommerce div.product .related.products ul.products li.product{width:calc(50% - 10px);}.woocommerce table.cart td.actions .button, .woocommerce #content table.cart td.actions .button, .woocommerce-page table.cart td.actions .button, .woocommerce-page #content table.cart td.actions .button{padding-left:1em;padding-right:1em;}.woocommerce #content table.cart .button, .woocommerce-page #content table.cart .button{width:100%;}.woocommerce #content table.cart .product-thumbnail, .woocommerce-page #content table.cart .product-thumbnail{display:block;text-align:center !important;}.woocommerce #content table.cart .product-thumbnail::before, .woocommerce-page #content table.cart .product-thumbnail::before{display:none;}.woocommerce #content table.cart td.actions .coupon, .woocommerce-page #content table.cart td.actions .coupon{float:none;}.woocommerce #content table.cart td.actions .coupon .button, .woocommerce-page #content table.cart td.actions .coupon .button{flex:1;}.woocommerce #content div.product .woocommerce-tabs ul.tabs li a, .woocommerce-page #content div.product .woocommerce-tabs ul.tabs li a{display:block;}}@media (max-width:544px){.woocommerce[class*="columns-"].columns-3 > ul.products li.product, .woocommerce[class*="columns-"].columns-4 > ul.products li.product, .woocommerce[class*="columns-"].columns-5 > ul.products li.product, .woocommerce[class*="columns-"].columns-6 > ul.products li.product{width:calc(50% - 10px);margin-right:20px;}.woocommerce-page[class*=columns-] ul.products li.product:nth-child(n), .woocommerce[class*=columns-] ul.products li.product:nth-child(n){margin-right:20px;clear:none;}.woocommerce-page[class*=columns-].columns-3>ul.products li.product:nth-child(2n), .woocommerce-page[class*=columns-].columns-4>ul.products li.product:nth-child(2n), .woocommerce-page[class*=columns-].columns-5>ul.products li.product:nth-child(2n), .woocommerce-page[class*=columns-].columns-6>ul.products li.product:nth-child(2n), .woocommerce[class*=columns-].columns-3>ul.products li.product:nth-child(2n), .woocommerce[class*=columns-].columns-4>ul.products li.product:nth-child(2n), .woocommerce[class*=columns-].columns-5>ul.products li.product:nth-child(2n), .woocommerce[class*=columns-].columns-6>ul.products li.product:nth-child(2n){margin-right:0;clear:right;}.woocommerce[class*="columns-"].columns-3 > ul.products li.product:nth-child(2n+1), .woocommerce[class*="columns-"].columns-4 > ul.products li.product:nth-child(2n+1), .woocommerce[class*="columns-"].columns-5 > ul.products li.product:nth-child(2n+1), .woocommerce[class*="columns-"].columns-6 > ul.products li.product:nth-child(2n+1){clear:left;}.woocommerce[class*="columns-"] ul.products li.product:nth-child(n), .woocommerce-page[class*="columns-"] ul.products li.product:nth-child(n){margin-right:20px;clear:none;}.woocommerce.mobile-columns-6 ul.products li.product:nth-child(6n), .woocommerce-page.mobile-columns-6 ul.products li.product:nth-child(6n), .woocommerce.mobile-columns-5 ul.products li.product:nth-child(5n), .woocommerce-page.mobile-columns-5 ul.products li.product:nth-child(5n), .woocommerce.mobile-columns-4 ul.products li.product:nth-child(4n), .woocommerce-page.mobile-columns-4 ul.products li.product:nth-child(4n), .woocommerce.mobile-columns-3 ul.products li.product:nth-child(3n), .woocommerce-page.mobile-columns-3 ul.products li.product:nth-child(3n), .woocommerce.mobile-columns-2 ul.products li.product:nth-child(2n), .woocommerce-page.mobile-columns-2 ul.products li.product:nth-child(2n), .woocommerce div.product .related.products ul.products li.product:nth-child(2n){margin-right:0;clear:right;}.woocommerce.mobile-columns-6 ul.products li.product:nth-child(6n+1), .woocommerce-page.mobile-columns-6 ul.products li.product:nth-child(6n+1), .woocommerce.mobile-columns-5 ul.products li.product:nth-child(5n+1), .woocommerce-page.mobile-columns-5 ul.products li.product:nth-child(5n+1), .woocommerce.mobile-columns-4 ul.products li.product:nth-child(4n+1), .woocommerce-page.mobile-columns-4 ul.products li.product:nth-child(4n+1), .woocommerce.mobile-columns-3 ul.products li.product:nth-child(3n+1), .woocommerce-page.mobile-columns-3 ul.products li.product:nth-child(3n+1), .woocommerce.mobile-columns-2 ul.products li.product:nth-child(2n+1), .woocommerce-page.mobile-columns-2 ul.products li.product:nth-child(2n+1), .woocommerce div.product .related.products ul.products li.product:nth-child(2n+1){clear:left;}.woocommerce ul.products a.button.loading::after, .woocommerce-page ul.products a.button.loading::after{display:inline-block;margin-left:5px;position:initial;}.woocommerce.mobile-columns-1 ul.products li.product:nth-child(n), .woocommerce-page.mobile-columns-1 ul.products li.product:nth-child(n){margin-right:0;}.woocommerce #content div.product .woocommerce-tabs ul.tabs li, .woocommerce-page #content div.product .woocommerce-tabs ul.tabs li{display:block;margin-right:0;}}@media (min-width:922px){.woocommerce #content .ast-woocommerce-container div.product div.images, .woocommerce .ast-woocommerce-container div.product div.images, .woocommerce-page #content .ast-woocommerce-container div.product div.images, .woocommerce-page .ast-woocommerce-container div.product div.images{width:50%;}.woocommerce #content .ast-woocommerce-container div.product div.summary, .woocommerce .ast-woocommerce-container div.product div.summary, .woocommerce-page #content .ast-woocommerce-container div.product div.summary, .woocommerce-page .ast-woocommerce-container div.product div.summary{width:46%;}.woocommerce.woocommerce-checkout form #customer_details.col2-set .col-1, .woocommerce.woocommerce-checkout form #customer_details.col2-set .col-2, .woocommerce-page.woocommerce-checkout form #customer_details.col2-set .col-1, .woocommerce-page.woocommerce-checkout form #customer_details.col2-set .col-2{float:none;width:auto;}}.woocommerce a.button , .woocommerce button.button.alt ,.woocommerce-page table.cart td.actions .button, .woocommerce-page #content table.cart td.actions .button , .woocommerce a.button.alt ,.woocommerce .woocommerce-message a.button , .ast-site-header-cart .widget_shopping_cart .buttons .button.checkout, .woocommerce button.button.alt.disabled , .wc-block-grid__products .wc-block-grid__product .wp-block-button__link {border:solid;border-top-width:0;border-right-width:0;border-left-width:0;border-bottom-width:0;border-color:rgba(9,132,225,0);}.woocommerce a.button:hover , .woocommerce button.button.alt:hover , .woocommerce-page table.cart td.actions .button:hover, .woocommerce-page #content table.cart td.actions .button:hover, .woocommerce a.button.alt:hover ,.woocommerce .woocommerce-message a.button:hover , .ast-site-header-cart .widget_shopping_cart .buttons .button.checkout:hover , .woocommerce button.button.alt.disabled:hover , .wc-block-grid__products .wc-block-grid__product .wp-block-button__link:hover{border-color:rgba(75,129,236,0);}@media (min-width:922px){.woocommerce.woocommerce-checkout form #customer_details.col2-set, .woocommerce-page.woocommerce-checkout form #customer_details.col2-set{width:55%;float:left;margin-right:4.347826087%;}.woocommerce.woocommerce-checkout form #order_review, .woocommerce.woocommerce-checkout form #order_review_heading, .woocommerce-page.woocommerce-checkout form #order_review, .woocommerce-page.woocommerce-checkout form #order_review_heading{width:40%;float:right;margin-right:0;clear:right;}}
</style><style id="woocommerce-inline-inline-css">
.woocommerce form .form-row .required { visibility: visible; }
</style><link rel="stylesheet" id="hfe-style-css" href="../wp-content/plugins/header-footer-elementor/assets/css/header-footer-elementor.css" media="all"><link rel="stylesheet" id="elementor-icons-css" href="../wp-content/plugins/elementor/assets/lib/eicons/css/elementor-icons.min.css" media="all"><link rel="stylesheet" id="elementor-animations-css" href="../wp-content/plugins/elementor/assets/lib/animations/animations.min.css" media="all"><link rel="stylesheet" id="elementor-frontend-css" href="../wp-content/plugins/elementor/assets/css/frontend.min.css" media="all"><link rel="stylesheet" id="elementor-post-682-css" href="../wp-content/uploads/elementor/css/post-682.css" media="all"><link rel="stylesheet" id="elementor-post-25878-css" href="../wp-content/uploads/elementor/css/post-25878.css" media="all"><link rel="stylesheet" id="hfe-widgets-style-css" href="../wp-content/plugins/header-footer-elementor/inc/widgets-css/frontend.css" media="all"><link rel="stylesheet" id="elementor-post-27423-css" href="../wp-content/uploads/elementor/css/post-27423.css" media="all"><link rel="stylesheet" id="google-fonts-1-css" href="https://fonts.googleapis.com/css?family=Roboto%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic%7CRoboto+Slab%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic&ver=5.7.1" media="all"><script src="../wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script><script src="../wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script><noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript><style>.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><style id="uagb-style-conditional-extension">@media (min-width: 1025px){.entry-content .uag-hide-desktop.uagb-google-map__wrap,.entry-content .uag-hide-desktop{display:none}}@media (min-width: 768px) and (max-width: 1024px){.entry-content .uag-hide-tab.uagb-google-map__wrap,.entry-content .uag-hide-tab{display:none}}@media (max-width: 767px){.entry-content .uag-hide-mob.uagb-google-map__wrap,.entry-content .uag-hide-mob{display:none}}</style><link rel="icon" href="../wp-content/uploads/2021/03/cropped-%E7%BC%96%E7%BB%84-44%E5%A4%87%E4%BB%BD-2-32x32.png" sizes="32x32"><link rel="icon" href="../wp-content/uploads/2021/03/cropped-%E7%BC%96%E7%BB%84-44%E5%A4%87%E4%BB%BD-2-192x192.png" sizes="192x192"><link rel="apple-touch-icon" href="../wp-content/uploads/2021/03/cropped-%E7%BC%96%E7%BB%84-44%E5%A4%87%E4%BB%BD-2-180x180.png"><meta name="msapplication-TileImage" content="../wp-content/uploads/2021/03/cropped-%E7%BC%96%E7%BB%84-44%E5%A4%87%E4%BB%BD-2-270x270.png"><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"></head><body class="post-template post-template-elementor_canvas single single-post postid-25878 single-format-standard wp-custom-logo theme-astra woocommerce-no-js ehf-footer ehf-template-astra ehf-stylesheet-astra group-blog ast-blog-single-style-1 ast-single-post ast-mobile-inherit-site-logo ast-replace-site-logo-transparent ast-inherit-site-logo-transparent astra-hfb-header ast-desktop ast-page-builder-template ast-no-sidebar astra-3.2.0 ast-full-width-primary-header elementor-default elementor-template-canvas elementor-kit-682 elementor-page elementor-page-25878">
			<div data-elementor-type="wp-post" data-elementor-id="25878" class="elementor elementor-25878" data-elementor-settings="[]">
							<div class="elementor-section-wrap">
							<section class="elementor-section elementor-top-section elementor-element elementor-element-2d9ff38e elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="2d9ff38e" data-element_type="section"><div class="elementor-container elementor-column-gap-default">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-4259f72a" data-id="4259f72a" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-39f1ee1 elementor-widget elementor-widget-text-editor" data-id="39f1ee1" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p></p>
<h2 id="activity-name" class="rich_media_title" style="text-align: center;">数字钱包 HD Wallet（BIP32密钥派生）</h2>
<p></p></div>
				</div>
				</div>
					</div>
		</div>
							</div>
		</section><section class="elementor-section elementor-top-section elementor-element elementor-element-34a9f0f4 elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="34a9f0f4" data-element_type="section"><div class="elementor-container elementor-column-gap-default">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-62542cca" data-id="62542cca" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-1819bb1f elementor-widget elementor-widget-spacer" data-id="1819bb1f" data-element_type="widget" data-widget_type="spacer.default">
				<div class="elementor-widget-container">
					<div class="elementor-spacer">
			<div class="elementor-spacer-inner"></div>
		</div>
				</div>
				</div>
				<div class="elementor-element elementor-element-67f81b2b elementor-widget elementor-widget-image" data-id="67f81b2b" data-element_type="widget" data-widget_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
										<img width="404" height="404" src="../wp-content/uploads/2021/04/blockcasting.png" class="attachment-full size-full" alt="" loading="lazy" srcset="../wp-content/uploads/2021/04/blockcasting.png 404w,../wp-content/uploads/2021/04/blockcasting-300x300.png 300w,../wp-content/uploads/2021/04/blockcasting-150x150.png 150w,../wp-content/uploads/2021/04/blockcasting-100x100.png 100w" sizes="(max-width: 404px) 100vw, 404px"></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-d0a0ad7 elementor-absolute elementor-widget elementor-widget-heading" data-id="d0a0ad7" data-element_type="widget" data-settings='{"_position":"absolute"}' data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h2 class="elementor-heading-title elementor-size-default">litianc</h2>		</div>
				</div>
				<div class="elementor-element elementor-element-5c91d103 elementor-absolute elementor-widget elementor-widget-text-editor" data-id="5c91d103" data-element_type="widget" data-settings='{"_position":"absolute"}' data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>2020-11-12</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a36113d elementor-widget-divider--view-line elementor-widget elementor-widget-divider" data-id="a36113d" data-element_type="widget" data-widget_type="divider.default">
				<div class="elementor-widget-container">
					<div class="elementor-divider">
			<span class="elementor-divider-separator">
						</span>
		</div>
				</div>
				</div>
				<div class="elementor-element elementor-element-41ea4d78 elementor-widget elementor-widget-text-editor" data-id="41ea4d78" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><div id="meta_content" class="rich_media_meta_list">
<div id="meta_content" class="rich_media_meta_list">
<h3 class="md-end-block md-heading"><span class="md-plain">前言</span></h3>
<p class="md-end-block md-p"><span class="md-plain">最近在看Filecoin应用，学习Filecoin的交易和签名工具，第一步就是导入HD Wallet。原以为这个出现在上古圣经《精通比特币》书中的概念早已人人尽知，实际调研后却发现中文技术社区的文章大多是BIP32的直接翻译，或是简单的接口使用讨论，更深入的问题如：“加固派生密钥为什么安全？”并没有被讨论。本文记录一下我关注的问题和理解，为希望进一步了解HD Wallet原理的朋友提供一些参考。</span></p>
<h3 class="md-end-block md-heading"><span class="md-plain">HD Wallet的由来</span></h3>
<p class="md-end-block md-p"><span class="md-plain">HD Wallet是分层确定性（Hierarchical Deterministic）钱包的简写。在HD Wallet出现之前，比特币钱包是通过随机数生成互不相关的多个私钥。这种类型的钱包被称作非确定钱包（或随机钱包）。</span></p>
<p class="md-end-block md-p"><span class="md-plain">在中本聪的UTXO模型中，客户端默认是每个比特币地址只能用一次交易，因此钱包使用过程中需要反复备份、导入再使用密钥进行签名交易，非常不便。</span></p>
<p class="md-end-block md-p"><span class="md-plain">为了解决非确定性钱包的私钥管理问题，社区成员提出了一种使用“种子”使用哈希函数单向生成一组的私钥的方法。并在这种思想的基础上，增加了密钥派生（BIP32）、助记词（BIP39）、派生路径规范（BIP43/44）等功能，形成了现在统一规范的HD wallet。</span></p>
<h3 class="md-end-block md-heading"><span class="md-plain">BIP32和它小伙伴们</span></h3>
<p class="md-end-block md-p"><span class="md-plain">BIP32是分层确定性钱包的核心改进，它基于严谨的密码学算法提出了一套先进的钱包管理方法。在BIP32刚提出来的年代，确定性钱包有两种主要类型：Electrum钱包和BIP32钱包；这两种钱包的算法和设计接近，但最终BIP32钱包成为了后来的标准。</span></p>
<p class="md-end-block md-p"><span class="md-plain">BIP39是比特币HD Wallet规范中最贴近用户的。只要使用过数字钱包的用户都会对它有印象，还记得手抄的私钥词组吗？它通过一组易于记忆的单词（助记词）来生成确定性钱包的种子密钥。</span></p>
<p class="md-end-block md-p"><span class="md-plain">BIP43和BIP44统一了钱包软件对分层路径和数字编号的理解和使用，使得了用户用相同的助记词在同一区块链中能够确定性地生成相同的一组密钥。</span></p>
<p class="md-end-block md-p"><span class="md-plain">BIP39、BIP43、BIP44都是兼容BIP32的协议，后来还被比特币以外的区块链所借鉴，形成了区块链行业的共识。本文重点关注密钥派生BIP32的细节问题，其他改进协议不一一展开介绍。</span></p>
<h3 class="md-end-block md-heading"><span class="md-plain">BIP32相关疑问</span></h3>
<p class="md-end-block md-p"><span class="md-plain">第一次阅读《精通比特币》时，大多数人对密码学的知识可能还是一知半解，对于超过理解范围的知识可能会选择跳过或抓住结论、忽略过程。所以会得出对HD Wallet的第一层理解：</span></p>
<blockquote>
<p class="md-end-block md-p"><span class="md-plain">HD钱包就是通过hash算法逐层衍生私钥，得到用一个种子（或助记词）管理无数多密钥的方法。</span></p>
</blockquote>
<p class="md-end-block md-p"><span class="md-plain">当再次翻看这章节时，关注到专用名词“扩展密钥“，得出HD Wallet的第二层理解：</span></p>
<blockquote>
<p class="md-end-block md-p"><span class="md-plain">HD钱包有一种设计，实现了父私钥派生子私钥，父公钥派生子公钥，子私钥和子公钥是“一对密钥”。</span></p>
</blockquote>
<p class="md-end-block md-p"><span class="md-plain">不禁提出疑问：</span></p>
<blockquote>
<p class="md-end-block md-p"><span class="md-plain">“父私钥”生成“子私钥”、“父公钥”生成“子公钥”，这是用某种神奇的算法实现？还是某种协议约定？或是整个系统里只用到一个“真-私钥”，而“子私钥”和“扩展密钥”只是定义出来的抽象的概念而已呢？</span></p>
</blockquote>
<h3 class="md-end-block md-heading"><span class="md-plain">确定性钱包的特点</span></h3>
<p class="md-end-block md-p"><span class="md-plain">我们说确定性钱包有两个直观特点：</span></p>
<ol class="ol-list" start=""><li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">可以通过父密钥获取子密钥（包括：父私钥获取子私钥、父公钥获取子公钥），但反之不成立；</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">可以公开主公钥，而不必担心资金损失。</span></p>
</li>
</ol><p class="md-end-block md-p"><span class="md-plain">宣传此特点的主要场景是在分层的组织中，比如公司将子私钥交给部门，将子公钥交给会计师和审计师，而将根私钥交给财务主管。这种算法带来的近乎神奇的功能，让许多人（包括懂技术的人）将HD Wallet的功能神化。但这样对分层钱包的描述存在致命的缺陷。</span></p>
<p class="md-end-block md-p"><span class="md-plain">这一缺陷也是我对HD Wallet的第三层理解：尽管可以安全地分发子私钥而对父私钥没有风险，也可以分发主公钥而对主私钥没有风险，但是不能同时进行这两种操作。其中的风险隐藏在分层确定性钱包的算法中，在介绍这一缺陷之前，我们先研究一下BIP32和密钥派生函数。</span></p>
<h3 class="md-end-block md-heading"><span class="md-plain">BIP32规范</span></h3>
<p class="md-end-block md-p"><span class="md-plain">为了更准确介绍BIP32的定义和内涵，我建议计算机专业背景的读者直接阅读</span><span class="md-meta-i-c md-link"><a spellcheck="false" href="https://en.bitcoin.it/wiki/BIP_0032"><span class="md-plain">BIP32规范</span></a><span class="md-plain">。</span></span></p>
<p class="md-end-block md-p"><span class="md-plain">BIP32规范中用了许多密码学公式来定义HD Wallet如何派生密钥，对于非计算机专业的同学不太友好。我们这里抛开密码学的严谨定义和推导，用白话描述BIP32规范。</span></p>
<p class="md-end-block md-p"><span class="md-plain">BIP32主要介绍了三个概念：密钥派生函数、密钥树和主密钥生成。</span></p>
<h4 class="md-end-block md-heading"><span class="md-plain">密钥派生函数（Child Key Derivation function）</span></h4>
<p class="md-end-block md-p md-focus"><span class="md-plain md-expand">密钥派生函数是一个经过特殊设计的函数，核心部分是使用消息认证码HMAC-SHA512（本质上是先对数据进行Hash，再进行对称加密）。HMAC-SHA512有个特点，就是当知道输入Data和Key时，能够得到输出I；仅知道输出I和输入Key，不能推导出Data。</span></p>
<p class="md-end-block md-p"><span class="md-pair-s" spellcheck="false"><code>I = HMAC-SHA512(Key, Data)</code></span></p>
<p class="md-end-block md-p"><span class="md-plain">父层的 </span><span class="md-pair-s" spellcheck="false"><code>I</code><span class="md-plain"> 决定分别取前32位和后32位作为拓展私钥和加密密钥，</span><code>Key</code><span class="md-plain">即使用加密密钥，</span><code>Data</code><span class="md-plain">由拓展私钥（或拓展公钥）和数字编号i经过简单的拼接得到。</span></span></p>
<p class="md-end-block md-p"><span class="md-plain">然后通过严谨的算法证明，得出我们先前提到的结论：父私钥派生出子私钥，父公钥派生出子公钥，子私钥和子公钥是一对密钥。（参考下图</span><span class="md-meta-i-c md-link"><a spellcheck="false" href="https://eprint.iacr.org/2014/848.pdf"><span class="md-plain">原文</span></a><span class="md-plain">）</span></span></p>
<p class="md-end-block md-p"><img loading="lazy" class="alignnone wp-image-26640 size-full" src="../wp-content/uploads/2021/04/image-20201112222504223.png" alt="" width="1168" height="684" srcset="../wp-content/uploads/2021/04/image-20201112222504223.png 1168w,../wp-content/uploads/2021/04/image-20201112222504223-300x176.png 300w,../wp-content/uploads/2021/04/image-20201112222504223-1024x600.png 1024w,../wp-content/uploads/2021/04/image-20201112222504223-768x450.png 768w,../wp-content/uploads/2021/04/image-20201112222504223-600x351.png 600w" sizes="(max-width: 1168px) 100vw, 1168px"></p>
<p class="md-end-block md-p"><span class="md-plain">此外，区别与一般密钥派生函数，人为设计了另一种函数“加硬”密钥派生。这里用数字编号i的首位（共32位）作为标识。当首位为0，即数字编号i < 2^31，采用一般密钥派生函数。首位为1，即i >= 2^31时，采用“加硬”密钥派生函数。对于“加硬”密钥派生函数，无论是获得子私钥还是子公钥，都需要使用父私钥进行派生计算，所以它失去了一般密钥派生函数中公钥直接派生公钥的特性，变得不灵活了，同时也更安全了，“加硬”了。后面会介绍加硬密钥的使用场景。</span></p>
<p class="md-end-block md-p"><img loading="lazy" class="alignnone wp-image-26755 size-full" src="../wp-content/uploads/2021/04/image-20201114123044822.png" alt="" width="418" height="434" srcset="../wp-content/uploads/2021/04/image-20201114123044822.png 418w,../wp-content/uploads/2021/04/image-20201114123044822-289x300.png 289w" sizes="(max-width: 418px) 100vw, 418px"></p>
<h4 class="md-end-block md-heading"><span class="md-plain">密钥树</span></h4>
<p class="md-end-block md-p"><span class="md-plain">由于密钥派生关系是可以多层迭代的，因此可以使用一个密钥多层级派生，构建出树形密钥层级结构。如果是普通密钥派生关系，公钥派生子公钥的特性也可以逐层传递。当某一层的密钥派生关系是“加硬”的，则这种传导关系就中止了。用公式可以表示为：</span></p>
<ul class="ul-list" data-mark="*"><li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">N(m/a/b/c) = N(m/a/b)/c = N(m/a)/b/c = N(m)/a/b/c = M/a/b/c.</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">N(m/aH/b/c) = N(m/aH/b)/c = N(m/aH)/b/c.</span></p>
</li>
</ul><p class="md-end-block md-p"><span class="md-pair-s "><em><span class="md-plain">H表示加硬密钥派生</span></em></span></p>
<p class="md-end-block md-p"><img loading="lazy" class="alignnone wp-image-26756 size-full" src="../wp-content/uploads/2021/04/image-20210203164925524.png" alt="" width="1746" height="1074" srcset="../wp-content/uploads/2021/04/image-20210203164925524.png 1746w,../wp-content/uploads/2021/04/image-20210203164925524-300x185.png 300w,../wp-content/uploads/2021/04/image-20210203164925524-1024x630.png 1024w,../wp-content/uploads/2021/04/image-20210203164925524-768x472.png 768w,../wp-content/uploads/2021/04/image-20210203164925524-1536x945.png 1536w,../wp-content/uploads/2021/04/image-20210203164925524-600x369.png 600w" sizes="(max-width: 1746px) 100vw, 1746px"></p>
<h4 class="md-end-block md-heading"><span class="md-plain">主密钥生成</span></h4>
<p class="md-end-block md-p"><span class="md-plain">前面说了密钥的派生功能和多层级派生关系，BIP32中还初步讨论了种子密钥和主密钥生成的方式。如上图种子可以是任意长度的值，经过一次HMAC-SHA512计算得到主密钥。</span></p>
<p class="md-end-block md-p"><span class="md-plain">BIP32建议使用一个PNG文件来处理种子数据的随机性问题。BIP32的小伙伴们，BIP39、BIP43、BIP44在主密钥生成方面做了更进一步的规范。</span></p>
<h3 class="md-end-block md-heading"><span class="md-plain">BIP32安全讨论</span></h3>
<p class="md-end-block md-p"><span class="md-plain">BIP32的安全问题是着手写这篇文章的动机之一。BIP32中一个已知的漏洞是前文提到的同时分发父公钥和子私钥情况下，父私钥将处于危险之中。在2013年，Vitalik在Bitcoinmagazine的</span><span class="md-meta-i-c md-link"><a spellcheck="false" href="https://bitcoinmagazine.com/articles/deterministic-wallets-advantages-flaw-1385450276"><span class="md-plain">博客</span></a><span class="md-plain">中已经指出这一风险，并使用代码进行论证。他分别对Electrum钱包和BIP32钱包进行测试，结果显示，通过已知父公钥和子私钥，不仅可以获得同级对其他子私钥，还可以破解得出父私钥。</span></span></p>
<pre class="md-fences md-end-block ty-contain-cm modeLoaded" lang="python" spellcheck="false"><span role="presentation"><span class="cm-operator">></span> <span class="cm-variable">wp</span> = <span class="cm-variable">bip32_privtopub</span>(<span class="cm-variable">w</span>)</span>
<span role="presentation"><span class="cm-operator">></span> <span class="cm-variable">w0</span> = <span class="cm-variable">bip32_ckd</span>(<span class="cm-variable">w</span>,<span class="cm-number">0</span>)</span>
<span role="presentation"><span class="cm-operator">></span> <span class="cm-variable">crack_bip32_privkey</span>(<span class="cm-variable">wp</span>,<span class="cm-variable">w0</span>)</span>
<span role="presentation"><span class="cm-string">'xprv9s21ZrQH143K2KhRQVuMqhz798mvW89J1aJMWEKNfZzv3BPAgBc4TH59K8ZcLt8RrNJvbUzA72A92Grm3MorG2FnFaoZ7B8SDTYXgUBALoi'</span></span></pre>
<ol class="ol-list" start=""><li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">精通比特币</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">BIP32. </span><span class="md-link md-pair-s" spellcheck="false"><a href="https://en.bitcoin.it/wiki/BIP_0032">https://en.bitcoin.it/wiki/BIP_0032</a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">Private Key Recovery Combination Attacks… </span><span class="md-link md-pair-s" spellcheck="false"><a href="https://eprint.iacr.org/2014/848.pdf">https://eprint.iacr.org/2014/848.pdf</a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">HD 钱包详解：Part 2——BIP32 注解. </span><span class="md-link md-pair-s" spellcheck="false"><a href="https://www.chainnews.com/articles/145568296316.htm">https://www.chainnews.com/articles/145568296316.htm</a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">Vitalik. Deterministic Wallets, Their Advantages And Their Understated Flaws. </span><span class="md-link md-pair-s" spellcheck="false"><a href="https://bitcoinmagazine.com/articles/deterministic-wallets-advantages-flaw-1385450276">https://bitcoinmagazine.com/articles/deterministic-wallets-advantages-flaw-1385450276</a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">千里之堤毁于蚁穴（慎用HD Wallets）. </span><span class="md-link md-pair-s" spellcheck="false"><a href="https://www.8btc.com/article/36233">https://www.8btc.com/article/36233</a></span></p>
</li>
</ol><h3 class="md-end-block md-heading"><span class="md-plain">参考文献</span></h3>
<p class="md-end-block md-p"><span class="md-plain">HD Wallet是当下主流数字钱包的首选。作为用户，在不同的钱包App中能够轻松的管理好自己的密钥；作为开发者，它提供了一套现成的、多语言的开发工具，降低了钱包软件的开发成本。作为想深入研究钱包原理，同时希望利用分层钱包特性设计一些创新场景的产品经理，需要注意设计时的安全考量，避免大规模使用后的密钥泄露问题。</span></p>
<h3 class="md-end-block md-heading"><span class="md-plain">总结</span></h3>
<p class="md-end-block md-p"><span class="md-plain">防范这个漏洞，公司或组织在使用BIP32的层级钱包时需要格外注意。对于一般用户，不必对HD Wallet的安全过于担心。因为相关的约定规范了钱包的派生流程，考虑的加硬的环节，同时，个人使用场景一般不涉及子密钥分发的问题，所以HD Wallet钱包进行密钥管理仍是安全的第一选择。</span></p>
<p class="md-end-block md-p"><span class="md-plain">因此，在密钥的分级管理中，当有可能同时透露父公钥和子私钥的情况下，不应该使用一般密钥派生方式，可以使用“加硬”密钥派生方式。</span></p>
</div>
</div></div>
				</div>
				</div>
					</div>
		</div>
							</div>
		</section><section class="elementor-section elementor-top-section elementor-element elementor-element-7157e527 elementor-section-full_width elementor-section-height-min-height elementor-section-items-top elementor-section-height-default" data-id="7157e527" data-element_type="section" data-settings='{"background_background":"classic"}'><div class="elementor-container elementor-column-gap-custom">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-7ecd0880" data-id="7ecd0880" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<section class="elementor-section elementor-inner-section elementor-element elementor-element-516fa673 elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="516fa673" data-element_type="section" data-settings='{"background_background":"classic"}'><div class="elementor-container elementor-column-gap-default">
					<div class="elementor-column elementor-col-100 elementor-inner-column elementor-element elementor-element-3723b46b" data-id="3723b46b" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-31a9dc85 elementor-widget elementor-widget-image" data-id="31a9dc85" data-element_type="widget" data-widget_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
										<img width="492" height="102" src="../wp-content/uploads/2021/03/cropped-%E7%BC%96%E7%BB%84-33@2x-1.png" class="attachment-full size-full" alt="" loading="lazy" srcset="../wp-content/uploads/2021/03/cropped-%E7%BC%96%E7%BB%84-33@2x-1.png 492w,../wp-content/uploads/2021/03/cropped-%E7%BC%96%E7%BB%84-33@2x-1-300x62.png 300w,../wp-content/uploads/2021/03/cropped-%E7%BC%96%E7%BB%84-33@2x-1-246x51.png 246w" sizes="(max-width: 492px) 100vw, 492px"></div>
				</div>
				</div>
					</div>
		</div>
							</div>
		</section><section class="elementor-section elementor-inner-section elementor-element elementor-element-2f658f9 elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="2f658f9" data-element_type="section"><div class="elementor-container elementor-column-gap-default">
					<div class="elementor-column elementor-col-50 elementor-inner-column elementor-element elementor-element-7e35da35" data-id="7e35da35" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-32957aeb elementor-widget elementor-widget-text-editor" data-id="32957aeb" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>致力于去中心化存储基础设施建设，提供完善的Filecoin矿池技术和存储应用的解决方案</p></div>
				</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-25 elementor-inner-column elementor-element elementor-element-34cd7922" data-id="34cd7922" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-34801a97 elementor-widget elementor-widget-text-editor" data-id="34801a97" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: right;">filecoin@blockcasting.io<br><span style="color: #3a3a3a; white-space: pre-wrap;">北京市朝阳区酒仙桥东路10号冠捷办公楼</span></p></div>
				</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-25 elementor-inner-column elementor-element elementor-element-45b18518" data-id="45b18518" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-5f6bd1c2 elementor-widget elementor-widget-image" data-id="5f6bd1c2" data-element_type="widget" data-widget_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
										<img src="../wp-content/uploads/elementor/thumbs/WechatIMG142-p5sjd9jazinrcy2u2lv1k056sctkez3jtkwwiaaxdi.jpeg" title="WechatIMG142" alt="WechatIMG142"></div>
				</div>
				</div>
					</div>
		</div>
							</div>
		</section></div>
		</div>
							</div>
		</section></div>
					</div>
			<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script><script id="astra-theme-js-js-extra">
var astra = {"break_point":"921","isRtl":""};
</script><script src="../wp-content/themes/astra/assets/js/minified/frontend.min.js" id="astra-theme-js-js"></script><script src="../wp-content/plugins/woocommerce/assets/js/jquery-blockui/jquery.blockUI.min.js" id="jquery-blockui-js"></script><script id="wc-add-to-cart-js-extra">
var wc_add_to_cart_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?wc-ajax=%%endpoint%%","i18n_view_cart":"\u67e5\u770b\u8d2d\u7269\u8f66","cart_url":"http:\/\/PLACEHOLDER.wpsho","is_cart":"","cart_redirect_after_add":"no"};
</script><script src="../wp-content/plugins/woocommerce/assets/js/frontend/add-to-cart.min.js" id="wc-add-to-cart-js"></script><script src="../wp-content/plugins/woocommerce/assets/js/js-cookie/js.cookie.min.js" id="js-cookie-js"></script><script id="woocommerce-js-extra">
var woocommerce_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?wc-ajax=%%endpoint%%"};
</script><script src="../wp-content/plugins/woocommerce/assets/js/frontend/woocommerce.min.js" id="woocommerce-js"></script><script id="wc-cart-fragments-js-extra">
var wc_cart_fragments_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?wc-ajax=%%endpoint%%","cart_hash_key":"wc_cart_hash_203e3601aaf8d7de9e49467df0de3724","fragment_name":"wc_fragments_203e3601aaf8d7de9e49467df0de3724","request_timeout":"5000"};
</script><script src="../wp-content/plugins/woocommerce/assets/js/frontend/cart-fragments.min.js" id="wc-cart-fragments-js"></script><script src="../wp-content/plugins/elementor/assets/js/webpack.runtime.min.js" id="elementor-webpack-runtime-js"></script><script src="../wp-content/plugins/elementor/assets/js/frontend-modules.min.js" id="elementor-frontend-modules-js"></script><script src="../wp-includes/js/jquery/ui/core.min.js" id="jquery-ui-core-js"></script><script src="../wp-content/plugins/elementor/assets/lib/dialog/dialog.min.js" id="elementor-dialog-js"></script><script src="../wp-content/plugins/elementor/assets/lib/waypoints/waypoints.min.js" id="elementor-waypoints-js"></script><script src="../wp-content/plugins/elementor/assets/lib/share-link/share-link.min.js" id="share-link-js"></script><script src="../wp-content/plugins/elementor/assets/lib/swiper/swiper.min.js" id="swiper-js"></script><script id="elementor-frontend-js-before">
var elementorFrontendConfig = {"environmentMode":{"edit":false,"wpPreview":false,"isScriptDebug":false,"isImprovedAssetsLoading":false},"i18n":{"shareOnFacebook":"\u5728\u8138\u4e66\u4e0a\u5206\u4eab","shareOnTwitter":"\u5206\u4eab\u5230Twitter","pinIt":"\u9489\u4f4f","download":"\u4e0b\u8f7d","downloadImage":"\u4e0b\u8f7d\u56fe\u7247","fullscreen":"\u5168\u5c4f","zoom":"\u7e2e\u653e","share":"\u5206\u4eab","playVideo":"\u64ad\u653e\u89c6\u9891","previous":"\u4e0a\u4e00\u9875","next":"\u4e0b\u4e00\u9875","close":"\u5173\u95ed"},"is_rtl":false,"breakpoints":{"xs":0,"sm":480,"md":768,"lg":1025,"xl":1440,"xxl":1600},"version":"3.1.4","is_static":false,"experimentalFeatures":{"e_dom_optimization":true,"a11y_improvements":true,"landing-pages":true},"urls":{"assets":"http:\/\/OFFLINEZIP.wpshowp-content\/plugins\/elementor\/assets\/"},"settings":{"page":[],"editorPreferences":[]},"kit":{"global_image_lightbox":"yes","lightbox_enable_counter":"yes","lightbox_enable_fullscreen":"yes","lightbox_enable_zoom":"yes","lightbox_enable_share":"yes","lightbox_title_src":"title","lightbox_description_src":"description"},"post":{"id":25878,"title":"%E6%95%B0%E5%AD%97%E9%92%B1%E5%8C%85%20HD%20Wallet%EF%BC%88BIP32%E5%AF%86%E9%92%A5%E6%B4%BE%E7%94%9F%EF%BC%89%20%E2%80%93%20blockcasting","excerpt":"\u6700\u8fd1\u5728\u770bFilecoin\u5e94\u7528\uff0c\u5b66\u4e60Filecoin\u7684\u4ea4\u6613\u548c\u7b7e\u540d\u5de5\u5177\uff0c\u7b2c\u4e00\u6b65\u5c31\u662f\u5bfc\u5165HD Wallet\u3002\u539f\u4ee5\u4e3a\u8fd9\u4e2a\u51fa\u73b0\u5728\u4e0a\u53e4\u5723\u7ecf\u300a\u7cbe\u901a\u6bd4\u7279\u5e01\u300b...","featuredImage":"http:\/\/OFFLINEZIP.wpshowp-content\/uploads\/2021\/04\/BIP-32-Integrated-into-Bitcoin-Core-1024x602.jpeg"}};
</script><script src="../wp-content/plugins/elementor/assets/js/frontend.min.js" id="elementor-frontend-js"></script><script src="../wp-content/plugins/elementor/assets/js/preloaded-elements-handlers.min.js" id="preloaded-elements-handlers-js"></script><script src="../wp-includes/js/underscore.min.js" id="underscore-js"></script><script id="wp-util-js-extra">
var _wpUtilSettings = {"ajax":{"url":"\/wp-admin\/admin-ajax.php"}};
</script><script src="../wp-includes/js/wp-util.min.js" id="wp-util-js"></script><script id="wpforms-elementor-js-extra">
var wpformsElementorVars = {"captcha_provider":"recaptcha","recaptcha_type":"v2"};
</script><script src="../wp-content/plugins/wpforms-lite/assets/js/integrations/elementor/frontend.min.js" id="wpforms-elementor-js"></script><script>
			/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
			</script></body></html>
